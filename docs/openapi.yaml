openapi: "3.0.3"
info:
  title: USTC Payment Portal API
  version: "0.1.3"
  description: API for integrating with Pay.gov payment services for the US Tax Court.
  contact:
    name: US Tax Court
servers:
  -
    url: "https://api.example.com"
    description: Production server

  -
    url: "http://localhost:8080"
    description: Local development server

tags:
  -
    name: Payments
    description: Payment initialization, processing, and status operations

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-api-key
      description: API key for authorization
  schemas:
    InitPaymentRequest:
      type: object
      properties:
        appId:
          type: string
          description: The application ID
          example: DAWSON
        transactionReferenceId:
          type: string
          format: uuid
          description: Unique UUID for the transaction reference
          example: "550e8400-e29b-41d4-a716-446655440000"
        urlSuccess:
          type: string
          format: uri
          description: URL to redirect to after successful payment
          example: "https://client.app/success"
        urlCancel:
          type: string
          format: uri
          description: URL to redirect to if payment is cancelled
          example: "https://client.app/cancel"
        metadata:
          type: object
          properties:
            docketNumber:
              type: string
              description: The docket number for the case
              example: "123456"
            petitionNumber:
              type: string
              description: The petition number
              example: PET-7890
          required:
            - docketNumber
            - petitionNumber
          description: Additional metadata for the payment
      required:
        - appId
        - transactionReferenceId
        - urlSuccess
        - urlCancel
        - metadata
    InitPaymentResponse:
      type: object
      properties:
        token:
          type: string
          description: Payment token for the initiated transaction
          example: abc123token
        paymentRedirect:
          type: string
          format: uri
          description: URL to redirect the user to complete payment on Pay.gov
          example: "https://pay.gov/payment?token=abc123token&tcsAppID=USTC_APP"
      required:
        - token
        - paymentRedirect
    ErrorResponse:
      type: object
      properties:
        statusCode:
          type: number
          description: HTTP status code
          example: 400
        message:
          type: string
          description: Error message
          example: Invalid request payload
      required:
        - statusCode
        - message
  parameters: {}
paths:
  /init:
    post:
      summary: Initialize a payment
      description: Creates a new payment session with Pay.gov and returns a redirect URL for the user to complete payment.
      tags:
        - Payments
      security:
        -
          ApiKeyAuth: []

      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InitPaymentRequest"
      responses:
        200:
          description: Payment initialized successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InitPaymentResponse"
        400:
          description: Invalid request payload
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        401:
          description: Unauthorized - invalid or missing API key
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        500:
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
