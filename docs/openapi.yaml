openapi: "3.0.3"
info:
  title: USTC Payment Portal API
  version: "0.1.3"
  description: API for integrating with Pay.gov payment services for the US Tax Court.
  contact:
    name: US Tax Court
servers:
  -
    url: "https://api.example.com"
    description: Production server

  -
    url: "http://localhost:8080"
    description: Local development server

tags:
  -
    name: Payments
    description: Payment initialization, processing, and status operations

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-api-key
      description: API key for authorization
  schemas:
    InitPaymentRequest:
      type: object
      properties:
        trackingId:
          type: string
          description: Unique identifier for tracking the payment
          example: TRK-12345
        amount:
          type: number
          minimum: 0
          exclusiveMinimum: true
          description: Payment amount in dollars
          example: 150
        appId:
          type: string
          description: The TCS application ID
          example: USTC_APP
        urlSuccess:
          type: string
          format: uri
          description: URL to redirect to after successful payment
          example: "https://example.com/success"
        urlCancel:
          type: string
          format: uri
          description: URL to redirect to if payment is cancelled
          example: "https://example.com/cancel"
      required:
        - trackingId
        - amount
        - appId
        - urlSuccess
        - urlCancel
    InitPaymentResponse:
      type: object
      properties:
        token:
          type: string
          description: Payment token for the initiated transaction
          example: abc123token
        paymentRedirect:
          type: string
          format: uri
          description: URL to redirect the user to complete payment on Pay.gov
          example: "https://pay.gov/payment?token=abc123token&tcsAppID=USTC_APP"
      required:
        - token
        - paymentRedirect
    ErrorResponse:
      type: object
      properties:
        statusCode:
          type: number
          description: HTTP status code
          example: 400
        message:
          type: string
          description: Error message
          example: Invalid request payload
      required:
        - statusCode
        - message
  parameters: {}
paths:
  /init:
    post:
      summary: Initialize a payment
      description: Creates a new payment session with Pay.gov and returns a redirect URL for the user to complete payment.
      tags:
        - Payments
      security:
        -
          ApiKeyAuth: []

      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InitPaymentRequest"
      responses:
        200:
          description: Payment initialized successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InitPaymentResponse"
        400:
          description: Invalid request payload
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        401:
          description: Unauthorized - invalid or missing API key
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        500:
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
